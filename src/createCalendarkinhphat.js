// https://kinhphat.org/cac-ngay-le-va-ngay-ram

let text
text = `

Tết Nguyên Đán	25/01/2020	12/02/2021	01/02/2022	22/01/2023	10/02/2024	29/01/2025	17/02/2026	06/02/2027
Rằm Tháng Giêng	08/02/2020	26/02/2021	15/02/2022	05/02/2023	24/02/2024	12/02/2025	03/03/2026	20/02/2027
Vía Phật Thích ca xuất gia (8/2)	01/03/2020	20/03/2021	10/03/2022	27/02/2023	17/03/2024	07/03/2025	26/03/2026	15/03/2027
Rằm Tháng Hai	08/03/2020	27/03/2021	17/03/2022	06/03/2023	24/03/2024	14/03/2025	02/04/2026	22/03/2027
Vía Quán Thế Âm Bồ Tát (19/2)	12/03/2020	31/03/2021	21/03/2022	10/03/2023	28/03/2024	18/03/2025	06/04/2026	26/03/2027
Vía Đức Phổ Hiền Bồ Tát (21/2)	14/03/2020	02/04/2021	23/03/2022	12/03/2023	30/03/2024	20/03/2025	08/04/2026	28/03/2027
Giỗ Tổ Hùng Vương (10/3)	02/04/2020	21/04/2021	10/04/2022	29/04/2023	18/04/2024	07/04/2025	26/04/2026	16/04/2027
Rằm Tháng Ba	07/04/2020	26/04/2021	15/04/2022	04/05/2023	23/04/2024	12/04/2025	01/05/2026	21/04/2027
Vía Đức Chuẩn Đề Bồ Tát (19/3)	11/04/2020	30/04/2021	19/04/2022	08/05/2023	27/04/2024	16/04/2025	05/05/2026	25/04/2027
Vía Đức Văn Thù Bồ Tát (4/4)	26/04/2020	15/05/2021	04/05/2022	22/05/2023	11/05/2024	01/05/2025	20/05/2026	09/05/2027
Phật Đản (15/4)	07/05/2020	26/05/2021	15/05/2022	02/06/2023	22/05/2024	12/05/2025	31/05/2026	20/05/2027
Lễ Đoan Ngọ (5/5)	25/06/2020	14/06/2021	03/06/2022	22/06/2023	10/06/2024	31/05/2025	19/06/2026	09/06/2027
Rằm Tháng Năm	05/07/2020	24/06/2021	13/06/2022	02/07/2023	20/06/2024	10/06/2025	29/06/2026	19/06/2027
Rằm Tháng Sáu	04/08/2020	24/07/2021	13/07/2022	01/08/2023	20/07/2024	09/07/2025	28/07/2026	18/07/2027
Vía Quán Thế Âm Bồ Tát (19/6)	08/08/2020	28/07/2021	17/07/2022	05/08/2023	24/07/2024	13/07/2025	01/08/2026	22/07/2027
Vía Đức Đại Thế Chí Bồ Tát (13/7)	31/08/2020	20/08/2021	10/08/2022	28/08/2023	16/08/2024	04/09/2025	25/08/2026	14/08/2027
Vu Lan (15/7)	02/09/2020	22/08/2021	12/08/2022	30/08/2023	18/08/2024	06/09/2025	27/08/2026	16/08/2027
Vía Đức Địa Tạng Bồ Tát (30/7)	17/09/2020	06/09/2021	27/08/2022	14/09/2023	02/09/2024	21/09/2025	11/09/2026	31/08/2027
Tết Trung Thu	01/10/2020	21/09/2021	10/09/2022	29/09/2023	17/09/2024	06/10/2025	25/09/2026	15/09/2027
Rằm Tháng Chín	31/10/2020	20/10/2021	10/10/2022	29/10/2023	17/10/2024	04/11/2025	24/10/2026	14/10/2027
Vía Quán Thế Âm Bồ Tát (19/9)	04/11/2020	24/10/2021	14/10/2022	02/11/2023	21/10/2024	08/11/2025	28/10/2026	18/10/2027
Vía Đức Phật Dược Sư (30/9)	15/11/2020	04/11/2021	25/10/2022	13/11/2023	01/11/2024	19/11/2025	08/11/2026	29/10/2027
Rằm Tháng Mười	29/11/2020	19/11/2021	08/11/2022	27/11/2023	15/11/2024	04/12/2025	23/11/2026	12/11/2027
Rằm Tháng Mười Một	28/12/2020	18/12/2021	08/12/2022	27/12/2023	15/12/2024	03/01/2026	23/12/2026	12/12/2027
Lễ Vía Phật A Di Đà (17/11)	30/12/2020	20/12/2021	10/12/2022	29/12/2023	17/12/2024	05/01/2026	25/12/2026	14/12/2027
Vía Đức Thích Ca thành đạo (8/12)	20/01/2021	10/01/2022	30/12/2022	18/01/2024	07/01/2025	26/01/2026	15/01/2027	04/01/2028
Rằm Tháng Chạp	27/01/2021	17/01/2022	06/01/2023	25/01/2024	14/01/2025	02/02/2026	22/01/2027	11/01/2028
Ông Táo chầu trời (23/12)	04/02/2021	25/01/2022	14/01/2023	02/02/2024	22/01/2025	10/02/2026	30/01/2027	19/01/2028

Tết Nguyên Đán	06/02/2027	26/01/2028	13/02/2029	02/02/2030	23/01/2031	11/02/2032	31/01/2033	19/02/2034
Rằm Tháng Giêng	20/02/2027	09/02/2028	27/02/2029	16/02/2030	06/02/2031	25/02/2032	14/02/2033	05/03/2034
Vía Phật Thích ca xuất gia (8/2)	15/03/2027	03/03/2028	22/03/2029	11/03/2030	28/02/2031	18/03/2032	08/03/2033	27/03/2034
Rằm Tháng Hai	22/03/2027	10/03/2028	29/03/2029	18/03/2030	07/03/2031	25/03/2032	15/03/2033	03/04/2034
Vía Quán Thế Âm Bồ Tát (19/2)	26/03/2027	14/03/2028	02/04/2029	22/03/2030	11/03/2031	29/03/2032	19/03/2033	07/04/2034
Vía Đức Phổ Hiền Bồ Tát (21/2)	28/03/2027	16/03/2028	04/04/2029	24/03/2030	13/03/2031	31/03/2032	21/03/2033	09/04/2034
Giỗ Tổ Hùng Vương (10/3)	16/04/2027	04/04/2028	23/04/2029	12/04/2030	01/04/2031	19/04/2032	09/04/2033	28/04/2034
Rằm Tháng Ba	21/04/2027	09/04/2028	28/04/2029	17/04/2030	06/04/2031	24/04/2032	14/04/2033	03/05/2034
Vía Đức Chuẩn Đề Bồ Tát (19/3)	25/04/2027	13/04/2028	02/05/2029	21/04/2030	10/04/2031	28/04/2032	18/04/2033	07/05/2034
Vía Đức Văn Thù Bồ Tát (4/4)	09/05/2027	28/04/2028	16/05/2029	05/05/2030	24/05/2031	12/05/2032	02/05/2033	21/05/2034
Phật Đản (15/4)	20/05/2027	09/05/2028	27/05/2029	16/05/2030	04/06/2031	23/05/2032	13/05/2033	01/06/2034
Lễ Đoan Ngọ (5/5)	09/06/2027	28/05/2028	16/06/2029	05/06/2030	24/06/2031	12/06/2032	01/06/2033	20/06/2034
Rằm Tháng Năm	19/06/2027	07/06/2028	26/06/2029	15/06/2030	04/07/2031	22/06/2032	11/06/2033	30/06/2034
Rằm Tháng Sáu	18/07/2027	05/08/2028	25/07/2029	15/07/2030	02/08/2031	21/07/2032	11/07/2033	30/07/2034
Vía Quán Thế Âm Bồ Tát (19/6)	22/07/2027	09/08/2028	29/07/2029	19/07/2030	06/08/2031	25/07/2032	15/07/2033	03/08/2034
Vía Đức Đại Thế Chí Bồ Tát (13/7)	14/08/2027	01/09/2028	22/08/2029	11/08/2030	30/08/2031	18/08/2032	07/08/2033	26/08/2034
Vu Lan (15/7)	16/08/2027	03/09/2028	24/08/2029	13/08/2030	01/09/2031	20/08/2032	09/08/2033	28/08/2034
Vía Đức Địa Tạng Bồ Tát (30/7)	31/08/2027	18/09/2028	08/09/2029	28/08/2030	16/09/2031	04/09/2032	24/08/2033	12/09/2034
Tết Trung Thu	15/09/2027	03/10/2028	22/09/2029	12/09/2030	01/10/2031	19/09/2032	08/09/2033	26/09/2034
Rằm Tháng Chín	14/10/2027	01/11/2028	22/10/2029	11/10/2030	30/10/2031	18/10/2032	07/10/2033	26/10/2034
Vía Quán Thế Âm Bồ Tát (19/9)	18/10/2027	05/11/2028	26/10/2029	15/10/2030	03/11/2031	22/10/2032	11/10/2033	30/10/2034
Vía Đức Phật Dược Sư (30/9)	29/10/2027	16/11/2028	06/11/2029	26/10/2030	14/11/2031	02/11/2032	22/10/2033	10/11/2034
Rằm Tháng Mười	12/11/2027	30/11/2028	20/11/2029	10/11/2030	29/11/2031	17/11/2032	06/11/2033	25/11/2034
Rằm Tháng Mười Một	12/12/2027	30/12/2028	19/12/2029	09/12/2030	28/12/2031	17/12/2032	06/12/2033	25/12/2034
Lễ Vía Phật A Di Đà (17/11)	14/12/2027	01/01/2029	21/12/2029	11/12/2030	30/12/2031	19/12/2032	08/12/2033	27/12/2034
Vía Đức Thích Ca thành đạo (8/12)	04/01/2028	22/01/2029	11/01/2030	01/01/2031	20/01/2032	08/01/2033	27/01/2034	16/01/2035
Rằm Tháng Chạp	11/01/2028	29/01/2029	18/01/2030	08/01/2031	27/01/2032	15/01/2033	03/02/2034	23/01/2035
Ông Táo chầu trời (23/12)	19/01/2028	06/02/2029	26/01/2030	16/01/2031	04/02/2032	23/01/2033	11/02/2034	31/01/2035



Tết Nguyên Đán	19/02/2034	08/02/2035	28/01/2036	15/02/2037	04/02/2038	24/01/2039	12/02/2040	01/02/2041
Rằm Tháng Giêng	05/03/2034	22/02/2035	11/02/2036	01/03/2037	18/02/2038	07/02/2039	26/02/2040	15/02/2041
Vía Phật Thích ca xuất gia (8/2)	27/03/2034	17/03/2035	05/03/2036	24/03/2037	13/03/2038	02/03/2039	20/03/2040	09/03/2041
Rằm Tháng Hai	03/04/2034	24/03/2035	12/03/2036	31/03/2037	20/03/2038	09/03/2039	27/03/2040	16/03/2041
Vía Quán Thế Âm Bồ Tát (19/2)	07/04/2034	28/03/2035	16/03/2036	04/04/2037	24/03/2038	13/03/2039	31/03/2040	20/03/2041
Vía Đức Phổ Hiền Bồ Tát (21/2)	09/04/2034	30/03/2035	18/03/2036	06/04/2037	26/03/2038	15/03/2039	02/04/2040	22/03/2041
Giỗ Tổ Hùng Vương (10/3)	28/04/2034	17/04/2035	06/04/2036	24/04/2037	13/04/2038	03/04/2039	20/04/2040	10/04/2041
Rằm Tháng Ba	03/05/2034	22/04/2035	11/04/2036	29/04/2037	18/04/2038	08/04/2039	25/04/2040	15/04/2041
Vía Đức Chuẩn Đề Bồ Tát (19/3)	07/05/2034	26/04/2035	15/04/2036	03/05/2037	22/04/2038	12/04/2039	29/04/2040	19/04/2041
Vía Đức Văn Thù Bồ Tát (4/4)	21/05/2034	11/05/2035	29/04/2036	18/05/2037	07/05/2038	26/04/2039	14/05/2040	03/05/2041
Phật Đản (15/4)	01/06/2034	22/05/2035	10/05/2036	29/05/2037	18/05/2038	07/05/2039	25/05/2040	14/05/2041
Lễ Đoan Ngọ (5/5)	20/06/2034	10/06/2035	30/05/2036	18/06/2037	07/06/2038	27/05/2039	14/06/2040	03/06/2041
Rằm Tháng Năm	30/06/2034	20/06/2035	09/06/2036	28/06/2037	17/06/2038	06/06/2039	24/06/2040	13/06/2041
Rằm Tháng Sáu	30/07/2034	19/07/2035	08/07/2036	27/07/2037	16/07/2038	04/08/2039	23/07/2040	12/07/2041
Vía Quán Thế Âm Bồ Tát (19/6)	03/08/2034	23/07/2035	12/07/2036	31/07/2037	20/07/2038	08/08/2039	27/07/2040	16/07/2041
Vía Đức Đại Thế Chí Bồ Tát (13/7)	26/08/2034	16/08/2035	03/09/2036	23/08/2037	13/08/2038	01/09/2039	20/08/2040	09/08/2041
Vu Lan (15/7)	28/08/2034	18/08/2035	05/09/2036	25/08/2037	15/08/2038	03/09/2039	22/08/2040	11/08/2041
Vía Đức Địa Tạng Bồ Tát (30/7)	12/09/2034	02/09/2035	20/09/2036	09/09/2037	30/08/2038	18/09/2039	06/09/2040	26/08/2041
Tết Trung Thu	26/09/2034	16/09/2035	04/10/2036	24/09/2037	13/09/2038	02/10/2039	20/09/2040	09/09/2041
Rằm Tháng Chín	26/10/2034	15/10/2035	02/11/2036	23/10/2037	13/10/2038	01/11/2039	20/10/2040	09/10/2041
Vía Quán Thế Âm Bồ Tát (19/9)	30/10/2034	19/10/2035	06/11/2036	27/10/2037	17/10/2038	05/11/2039	24/10/2040	13/10/2041
Vía Đức Phật Dược Sư (30/9)	10/11/2034	30/10/2035	17/11/2036	07/11/2037	28/10/2038	16/11/2039	04/11/2040	24/10/2041
Rằm Tháng Mười	25/11/2034	14/11/2035	02/12/2036	21/11/2037	11/11/2038	30/11/2039	19/11/2040	08/11/2041
Rằm Tháng Mười Một	25/12/2034	14/12/2035	31/12/2036	21/12/2037	10/12/2038	29/12/2039	18/12/2040	08/12/2041
Lễ Vía Phật A Di Đà (17/11)	27/12/2034	16/12/2035	02/01/2037	23/12/2037	12/12/2038	31/12/2039	20/12/2040	10/12/2041
Vía Đức Thích Ca thành đạo (8/12)	16/01/2035	05/01/2036	23/01/2037	12/01/2038	02/01/2039	21/01/2040	10/01/2041	30/12/2041
Rằm Tháng Chạp	23/01/2035	12/01/2036	30/01/2037	19/01/2038	09/01/2039	28/01/2040	17/01/2041	06/01/2042
Ông Táo chầu trời (23/12)	31/01/2035	20/01/2036	07/02/2037	27/01/2038	17/01/2039	05/02/2040	25/01/2041	14/01/2042
`


text = text.trim()
text = text.split('\n')
text = text.filter(x => x)
text = text.join('\n')

//////////////

let parsedText
parsedText = text
parsedText = parsedText.split('\n')
parsedText = parsedText.map(x => x.split('\t'))

// console.log(parsedText[0])

let events = [];

for (let i = 0; i < parsedText.length; i++) {
    for (let j = 0; j < parsedText[i].length; j++) {
        if (j == 0) continue

        let date = parsedText[i][j]
        let title = parsedText[i][0]
        let description = title + ' ' + date
        const moment = require('moment')
        let start = moment(date, 'DD/MM/YYYY').format('YYYY-M-D-H-m').split("-").map((a) => parseInt(a))


        let event = {
            title,
            start,
            duration: { days: 1},
            description
        }
        events.push(event);
    }
}





// import open, { apps } from 'open';

// for (let i = 0; i < 50; i++) {
//     let link = events[i]
//     open(link)
// }

// console.log(events)




const ics = require('ics')

const { writeFileSync } = require('fs')

writeFileSync(`${__dirname}/events.ics`, ics.createEvents(events).value)